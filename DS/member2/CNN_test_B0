{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"YU1KfyDKQXQR"},"outputs":[],"source":["import os\n","import io\n","from zipfile import ZipFile\n","import pandas as pd\n","import tensorflow as tf\n","from PIL import Image\n","import numpy as np\n","import random\n","import matplotlib.image as mpimg\n","import matplotlib.pyplot as plt\n","import cv2\n","from sklearn.metrics import *\n","import os\n","import zipfile\n","from google.colab import drive\n","from keras.utils import np_utils\n","from sklearn.model_selection import train_test_split\n","from tensorflow.keras.preprocessing.image import ImageDataGenerator"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sZU6PSQpQdmo","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672832493155,"user_tz":-540,"elapsed":17322,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"0914ab0f-053e-4155-aff3-95e8055a338a"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GSeRTV9lQdrX"},"outputs":[],"source":["import os\n","import zipfile\n","local_zip = '/content/drive/MyDrive/eyes_train.zip'\n","zip_ref = zipfile.ZipFile(local_zip, 'r')\n","zip_ref.extractall('/content')\n","zip_ref.close()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mgJ9dqhqQdvf"},"outputs":[],"source":["img_dir0 = '/content/eyes_train/eye_train/0'\n","img0 = os.listdir(img_dir0)\n","image0 = list(filter(lambda x: x.find('.jpg') != -1 or x.find('.png') != -1, img0))\n","label0 = list(filter(lambda x : x.find('.json')!=-1,img0))\n","image_0 = []\n","gray_0 = []\n","image_label0 = []\n","for i in image0:\n","    img = np.array(Image.open('/content/eyes_train/eye_train/0/{}'.format(i)))\n","    im0 = cv2.resize(img,(96,96))\n","    image_0.append(im0)\n","    m0 = cv2.cvtColor(im0,cv2.COLOR_BGR2GRAY)\n","    gray_0.append(m0)\n","    image_label0.append(0)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WQr3R50dYS8P"},"outputs":[],"source":["img_dir1 = '/content/eyes_train/eye_train/1'\n","img1 = os.listdir(img_dir1)\n","image1 = list(filter(lambda x: x.find('.jpg') != -1 or x.find('.png') != -1, img1))\n","label1 = list(filter(lambda x : x.find('.json')!=-1,img1))\n","for i in image1:\n","    img = np.array(Image.open('/content/eyes_train/eye_train/1/{}'.format(i)))\n","    im1 = cv2.resize(img,(96,96))\n","    image_0.append(im1)\n","    m1 = cv2.cvtColor(im1,cv2.COLOR_BGR2GRAY)\n","    gray_0.append(m1)\n","    image_label0.append(1)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YdRLzUZuYgdV"},"outputs":[],"source":["img_dir2 = '/content/eyes_train/eye_train/2'\n","img2 = os.listdir(img_dir2)\n","image2 = list(filter(lambda x: x.find('.jpg') != -1 or x.find('.png') != -1, img2))\n","label2 = list(filter(lambda x : x.find('.json')!=-1,img2))\n","for i in image2:\n","    img = np.array(Image.open('/content/eyes_train/eye_train/2/{}'.format(i)))\n","    im2 = cv2.resize(img,(96,96))\n","    image_0.append(im2)\n","    m2 = cv2.cvtColor(im2,cv2.COLOR_BGR2GRAY)\n","    gray_0.append(m2)\n","    image_label0.append(2)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Z-gR29u-YrO-"},"outputs":[],"source":["img_dir3 = '/content/eyes_train/eye_train/3'\n","img3 = os.listdir(img_dir3)\n","image3 = list(filter(lambda x: x.find('.jpg') != -1 or x.find('.png') != -1, img3))\n","label3 = list(filter(lambda x : x.find('.json')!=-1,img3))\n","for i in image3:\n","    img = np.array(Image.open('/content/eyes_train/eye_train/3/{}'.format(i)))\n","    im3 = cv2.resize(img,(96,96))\n","    image_0.append(im3)\n","    m3 = cv2.cvtColor(im3,cv2.COLOR_BGR2GRAY)\n","    gray_0.append(m3)\n","    image_label0.append(3)"]},{"cell_type":"code","source":["len(image_0)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"e2YCqittQMfv","executionInfo":{"status":"ok","timestamp":1672832586663,"user_tz":-540,"elapsed":32,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"69e7b539-ec6a-4344-bc25-c418c3a7c2dc"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["27520"]},"metadata":{},"execution_count":8}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"u2TuxEw8Y3ed"},"outputs":[],"source":["x = np.array(image_0)"]},{"cell_type":"code","source":["x.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"d2ixk-JpMOvv","executionInfo":{"status":"ok","timestamp":1672832587130,"user_tz":-540,"elapsed":26,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"8784babd-ba09-464a-e1e3-5f03ca05f506"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(27520, 96, 96, 3)"]},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":["x_gray = np.array(gray_0)"],"metadata":{"id":"IS4BT83LQiD_"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["x_gray.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"nR7PBOJDQtC3","executionInfo":{"status":"ok","timestamp":1672832587131,"user_tz":-540,"elapsed":23,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"a8d1aca2-6dbc-4e57-98a8-a27db87d9978"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(27520, 96, 96)"]},"metadata":{},"execution_count":12}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ytapCecaahIW"},"outputs":[],"source":["y = np.array(image_label0)"]},{"cell_type":"code","source":["y.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HmPySCYaSAZY","executionInfo":{"status":"ok","timestamp":1672832587133,"user_tz":-540,"elapsed":21,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"0f275f5a-37a4-4f45-d6fe-d94748b1ace4"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(27520,)"]},"metadata":{},"execution_count":14}]},{"cell_type":"code","source":["y = y.reshape(27520,1)"],"metadata":{"id":"b0y-ocW8IPW_"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["y"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Y2SqiLOqSFA5","executionInfo":{"status":"ok","timestamp":1672832587134,"user_tz":-540,"elapsed":17,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"e1667109-d4c1-48ce-8d17-8f556def7cbc"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0],\n","       [0],\n","       [0],\n","       ...,\n","       [3],\n","       [3],\n","       [3]])"]},"metadata":{},"execution_count":16}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eTtjlQCBZKwG"},"outputs":[],"source":["from keras.utils import np_utils\n","y = np_utils.to_categorical(y)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sBiRvd3nZMd9"},"outputs":[],"source":["#데이터 분할\n","from sklearn.model_selection import train_test_split\n","x_train, x_val, y_train, y_val = train_test_split(x, y, shuffle =True, test_size = 0.2, random_state = 123)"]},{"cell_type":"code","source":["# 모형(단순모형, 복잡한 함수형 모형)\n","from keras.layers.convolutional import Conv2D\n","from keras.layers.convolutional import MaxPooling2D\n","from keras.layers import Dense\n","from keras.layers import Flatten\n","from keras.optimizers import Adam\n","\n","model  = tf.keras.models.Sequential()\n","model.add(Conv2D(32, padding = 'same', kernel_size=(5,5), activation='relu', input_shape=(224,224,3)))\n","model.add(MaxPooling2D(pool_size=(2, 2),padding = 'same'))\n","\n","model.add(Conv2D(64,kernel_size=(3,3),activation='relu', padding = 'same'))\n","model.add(MaxPooling2D(pool_size=(2, 2), padding = 'same'))\n","\n","model.add(Conv2D(64,kernel_size=(5,5),activation='relu', padding = 'same'))\n","model.add(MaxPooling2D(pool_size=(2, 2), padding = 'same'))\n","\n","model.add(Conv2D(128,kernel_size=(3,3),activation='relu', padding = 'same'))\n","model.add(MaxPooling2D(pool_size=(2, 2), padding = 'same'))\n","\n","model.add(Conv2D(128,kernel_size=(5,5),activation='relu', padding = 'same'))\n","model.add(MaxPooling2D(pool_size=(2, 2), padding = 'same') )\n","\n","model.add(Flatten())\n","model.add(Dense(256,activation='relu'))\n","model.add(Dense(4,activation='softmax'))\n","\n","model.compile(optimizer=Adam(1e-03), \n","              loss = 'categorical_crossentropy', \n","              metrics = ['accuracy'])"],"metadata":{"id":"LsPn2myrIonc"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model.summary()"],"metadata":{"id":"aBluEgifigz8","executionInfo":{"status":"ok","timestamp":1672965927221,"user_tz":-540,"elapsed":15,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"5005b13c-6147-4791-f87c-5ee2ca6f3df8","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"sequential\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," conv2d (Conv2D)             (None, 96, 96, 32)        2432      \n","                                                                 \n"," max_pooling2d (MaxPooling2D  (None, 48, 48, 32)       0         \n"," )                                                               \n","                                                                 \n"," conv2d_1 (Conv2D)           (None, 48, 48, 64)        18496     \n","                                                                 \n"," max_pooling2d_1 (MaxPooling  (None, 24, 24, 64)       0         \n"," 2D)                                                             \n","                                                                 \n"," conv2d_2 (Conv2D)           (None, 24, 24, 64)        102464    \n","                                                                 \n"," max_pooling2d_2 (MaxPooling  (None, 12, 12, 64)       0         \n"," 2D)                                                             \n","                                                                 \n"," conv2d_3 (Conv2D)           (None, 12, 12, 128)       73856     \n","                                                                 \n"," max_pooling2d_3 (MaxPooling  (None, 6, 6, 128)        0         \n"," 2D)                                                             \n","                                                                 \n"," conv2d_4 (Conv2D)           (None, 6, 6, 128)         409728    \n","                                                                 \n"," max_pooling2d_4 (MaxPooling  (None, 3, 3, 128)        0         \n"," 2D)                                                             \n","                                                                 \n"," flatten (Flatten)           (None, 1152)              0         \n","                                                                 \n"," dense (Dense)               (None, 256)               295168    \n","                                                                 \n"," dense_1 (Dense)             (None, 4)                 1028      \n","                                                                 \n","=================================================================\n","Total params: 903,172\n","Trainable params: 903,172\n","Non-trainable params: 0\n","_________________________________________________________________\n"]}]},{"cell_type":"code","source":["import time\n","start_time  = time.time()\n","hist = model.fit(x_train, y_train, \n","                    epochs = 100, \n","                    batch_size = 32, \n","                    validation_data = (x_val, y_val), verbose=1)\n","print(f'fit_time :{time.time() - start_time}')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"EN4NiDiRIyK8","outputId":"07c71e7a-6314-40b0-d2c9-3d6cdec0dfac","executionInfo":{"status":"ok","timestamp":1672832969541,"user_tz":-540,"elapsed":378659,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/100\n","688/688 [==============================] - 14s 6ms/step - loss: 1.0864 - accuracy: 0.5479 - val_loss: 0.7931 - val_accuracy: 0.6137\n","Epoch 2/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.7783 - accuracy: 0.6185 - val_loss: 0.7209 - val_accuracy: 0.6512\n","Epoch 3/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.7285 - accuracy: 0.6514 - val_loss: 0.7212 - val_accuracy: 0.6523\n","Epoch 4/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.6973 - accuracy: 0.6736 - val_loss: 0.7139 - val_accuracy: 0.6717\n","Epoch 5/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.6615 - accuracy: 0.6925 - val_loss: 0.6904 - val_accuracy: 0.6741\n","Epoch 6/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.6341 - accuracy: 0.7104 - val_loss: 0.7010 - val_accuracy: 0.6735\n","Epoch 7/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.5936 - accuracy: 0.7336 - val_loss: 0.6631 - val_accuracy: 0.6984\n","Epoch 8/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.5650 - accuracy: 0.7472 - val_loss: 0.6714 - val_accuracy: 0.7091\n","Epoch 9/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.5329 - accuracy: 0.7631 - val_loss: 0.6463 - val_accuracy: 0.7104\n","Epoch 10/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.4986 - accuracy: 0.7827 - val_loss: 0.7032 - val_accuracy: 0.7098\n","Epoch 11/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.4493 - accuracy: 0.8066 - val_loss: 0.6900 - val_accuracy: 0.7218\n","Epoch 12/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.4175 - accuracy: 0.8254 - val_loss: 0.6960 - val_accuracy: 0.7124\n","Epoch 13/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.3698 - accuracy: 0.8471 - val_loss: 0.8051 - val_accuracy: 0.7169\n","Epoch 14/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.3283 - accuracy: 0.8651 - val_loss: 0.9222 - val_accuracy: 0.7055\n","Epoch 15/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.2940 - accuracy: 0.8844 - val_loss: 1.0031 - val_accuracy: 0.7044\n","Epoch 16/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.2508 - accuracy: 0.9005 - val_loss: 0.9500 - val_accuracy: 0.7269\n","Epoch 17/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.2322 - accuracy: 0.9103 - val_loss: 0.9797 - val_accuracy: 0.7069\n","Epoch 18/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.2069 - accuracy: 0.9234 - val_loss: 1.0396 - val_accuracy: 0.7133\n","Epoch 19/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1705 - accuracy: 0.9365 - val_loss: 1.1932 - val_accuracy: 0.7233\n","Epoch 20/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1872 - accuracy: 0.9329 - val_loss: 1.2164 - val_accuracy: 0.7253\n","Epoch 21/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1480 - accuracy: 0.9472 - val_loss: 1.2903 - val_accuracy: 0.7169\n","Epoch 22/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.2011 - accuracy: 0.9306 - val_loss: 1.0656 - val_accuracy: 0.7144\n","Epoch 23/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1343 - accuracy: 0.9529 - val_loss: 1.2742 - val_accuracy: 0.7180\n","Epoch 24/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1191 - accuracy: 0.9591 - val_loss: 1.4357 - val_accuracy: 0.7316\n","Epoch 25/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1346 - accuracy: 0.9545 - val_loss: 1.3687 - val_accuracy: 0.7313\n","Epoch 26/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1314 - accuracy: 0.9563 - val_loss: 1.1436 - val_accuracy: 0.7355\n","Epoch 27/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1224 - accuracy: 0.9593 - val_loss: 1.4616 - val_accuracy: 0.7327\n","Epoch 28/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1251 - accuracy: 0.9596 - val_loss: 1.1892 - val_accuracy: 0.7300\n","Epoch 29/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1079 - accuracy: 0.9647 - val_loss: 1.2966 - val_accuracy: 0.7313\n","Epoch 30/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1261 - accuracy: 0.9594 - val_loss: 1.0997 - val_accuracy: 0.7307\n","Epoch 31/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1024 - accuracy: 0.9667 - val_loss: 1.5555 - val_accuracy: 0.7229\n","Epoch 32/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1355 - accuracy: 0.9555 - val_loss: 1.4693 - val_accuracy: 0.7260\n","Epoch 33/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1238 - accuracy: 0.9612 - val_loss: 1.6354 - val_accuracy: 0.7151\n","Epoch 34/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1019 - accuracy: 0.9678 - val_loss: 1.6509 - val_accuracy: 0.7282\n","Epoch 35/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0988 - accuracy: 0.9675 - val_loss: 1.6406 - val_accuracy: 0.7244\n","Epoch 36/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0930 - accuracy: 0.9688 - val_loss: 1.4778 - val_accuracy: 0.7286\n","Epoch 37/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1055 - accuracy: 0.9663 - val_loss: 1.3935 - val_accuracy: 0.7144\n","Epoch 38/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1051 - accuracy: 0.9653 - val_loss: 1.6495 - val_accuracy: 0.7378\n","Epoch 39/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1595 - accuracy: 0.9529 - val_loss: 1.5872 - val_accuracy: 0.7291\n","Epoch 40/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0856 - accuracy: 0.9752 - val_loss: 1.4919 - val_accuracy: 0.7326\n","Epoch 41/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0749 - accuracy: 0.9772 - val_loss: 1.8868 - val_accuracy: 0.7331\n","Epoch 42/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0888 - accuracy: 0.9732 - val_loss: 1.9789 - val_accuracy: 0.7400\n","Epoch 43/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1170 - accuracy: 0.9667 - val_loss: 1.2591 - val_accuracy: 0.7160\n","Epoch 44/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0838 - accuracy: 0.9752 - val_loss: 1.8538 - val_accuracy: 0.7416\n","Epoch 45/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0958 - accuracy: 0.9705 - val_loss: 1.8908 - val_accuracy: 0.7307\n","Epoch 46/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0936 - accuracy: 0.9731 - val_loss: 1.5819 - val_accuracy: 0.7238\n","Epoch 47/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1087 - accuracy: 0.9669 - val_loss: 1.6154 - val_accuracy: 0.7340\n","Epoch 48/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0906 - accuracy: 0.9738 - val_loss: 1.3444 - val_accuracy: 0.7111\n","Epoch 49/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1569 - accuracy: 0.9554 - val_loss: 1.7438 - val_accuracy: 0.7289\n","Epoch 50/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0761 - accuracy: 0.9779 - val_loss: 1.9160 - val_accuracy: 0.7249\n","Epoch 51/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0634 - accuracy: 0.9815 - val_loss: 1.6605 - val_accuracy: 0.7273\n","Epoch 52/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0690 - accuracy: 0.9811 - val_loss: 1.9716 - val_accuracy: 0.7400\n","Epoch 53/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0824 - accuracy: 0.9756 - val_loss: 2.1018 - val_accuracy: 0.7346\n","Epoch 54/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1021 - accuracy: 0.9702 - val_loss: 2.0633 - val_accuracy: 0.7182\n","Epoch 55/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0979 - accuracy: 0.9721 - val_loss: 1.9602 - val_accuracy: 0.7316\n","Epoch 56/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1367 - accuracy: 0.9638 - val_loss: 1.7947 - val_accuracy: 0.7215\n","Epoch 57/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0742 - accuracy: 0.9792 - val_loss: 1.7239 - val_accuracy: 0.7307\n","Epoch 58/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0606 - accuracy: 0.9836 - val_loss: 1.6673 - val_accuracy: 0.7346\n","Epoch 59/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.2038 - accuracy: 0.9475 - val_loss: 1.5475 - val_accuracy: 0.7380\n","Epoch 60/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0651 - accuracy: 0.9825 - val_loss: 2.1019 - val_accuracy: 0.7278\n","Epoch 61/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0796 - accuracy: 0.9778 - val_loss: 1.6421 - val_accuracy: 0.7444\n","Epoch 62/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0442 - accuracy: 0.9876 - val_loss: 1.7398 - val_accuracy: 0.7287\n","Epoch 63/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1102 - accuracy: 0.9695 - val_loss: 1.6374 - val_accuracy: 0.7095\n","Epoch 64/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1179 - accuracy: 0.9682 - val_loss: 1.5934 - val_accuracy: 0.7331\n","Epoch 65/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0902 - accuracy: 0.9762 - val_loss: 1.6815 - val_accuracy: 0.7340\n","Epoch 66/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0418 - accuracy: 0.9882 - val_loss: 1.9548 - val_accuracy: 0.7275\n","Epoch 67/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1028 - accuracy: 0.9744 - val_loss: 1.5298 - val_accuracy: 0.7291\n","Epoch 68/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.2363 - accuracy: 0.9413 - val_loss: 1.4339 - val_accuracy: 0.7313\n","Epoch 69/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0798 - accuracy: 0.9789 - val_loss: 1.9511 - val_accuracy: 0.7358\n","Epoch 70/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0685 - accuracy: 0.9836 - val_loss: 1.8524 - val_accuracy: 0.7298\n","Epoch 71/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1676 - accuracy: 0.9583 - val_loss: 1.6856 - val_accuracy: 0.7289\n","Epoch 72/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1096 - accuracy: 0.9735 - val_loss: 1.6354 - val_accuracy: 0.7335\n","Epoch 73/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0474 - accuracy: 0.9871 - val_loss: 1.9783 - val_accuracy: 0.7344\n","Epoch 74/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1243 - accuracy: 0.9687 - val_loss: 1.3238 - val_accuracy: 0.7347\n","Epoch 75/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1105 - accuracy: 0.9717 - val_loss: 2.0096 - val_accuracy: 0.7202\n","Epoch 76/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0616 - accuracy: 0.9825 - val_loss: 2.1489 - val_accuracy: 0.7255\n","Epoch 77/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0628 - accuracy: 0.9833 - val_loss: 1.6795 - val_accuracy: 0.7280\n","Epoch 78/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1280 - accuracy: 0.9673 - val_loss: 1.6876 - val_accuracy: 0.7284\n","Epoch 79/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0819 - accuracy: 0.9793 - val_loss: 1.5566 - val_accuracy: 0.7264\n","Epoch 80/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0679 - accuracy: 0.9807 - val_loss: 2.4052 - val_accuracy: 0.7375\n","Epoch 81/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1802 - accuracy: 0.9564 - val_loss: 2.0101 - val_accuracy: 0.7057\n","Epoch 82/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1586 - accuracy: 0.9600 - val_loss: 1.7821 - val_accuracy: 0.7169\n","Epoch 83/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0701 - accuracy: 0.9807 - val_loss: 1.6423 - val_accuracy: 0.7371\n","Epoch 84/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0449 - accuracy: 0.9877 - val_loss: 1.6169 - val_accuracy: 0.7275\n","Epoch 85/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0969 - accuracy: 0.9767 - val_loss: 1.6172 - val_accuracy: 0.7298\n","Epoch 86/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1382 - accuracy: 0.9636 - val_loss: 1.8740 - val_accuracy: 0.7227\n","Epoch 87/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1009 - accuracy: 0.9761 - val_loss: 1.6836 - val_accuracy: 0.7148\n","Epoch 88/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0778 - accuracy: 0.9806 - val_loss: 1.5574 - val_accuracy: 0.7273\n","Epoch 89/100\n","688/688 [==============================] - 4s 6ms/step - loss: 0.1211 - accuracy: 0.9700 - val_loss: 2.0737 - val_accuracy: 0.7247\n","Epoch 90/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0722 - accuracy: 0.9807 - val_loss: 1.9148 - val_accuracy: 0.7373\n","Epoch 91/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0388 - accuracy: 0.9892 - val_loss: 2.6158 - val_accuracy: 0.7376\n","Epoch 92/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1139 - accuracy: 0.9695 - val_loss: 2.3407 - val_accuracy: 0.7277\n","Epoch 93/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1301 - accuracy: 0.9688 - val_loss: 1.8596 - val_accuracy: 0.6839\n","Epoch 94/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1063 - accuracy: 0.9709 - val_loss: 1.6262 - val_accuracy: 0.7131\n","Epoch 95/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.3342 - accuracy: 0.9117 - val_loss: 1.9156 - val_accuracy: 0.7326\n","Epoch 96/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0948 - accuracy: 0.9767 - val_loss: 1.6527 - val_accuracy: 0.7358\n","Epoch 97/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0807 - accuracy: 0.9807 - val_loss: 2.0581 - val_accuracy: 0.7142\n","Epoch 98/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0532 - accuracy: 0.9858 - val_loss: 1.9576 - val_accuracy: 0.7037\n","Epoch 99/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1509 - accuracy: 0.9648 - val_loss: 2.1257 - val_accuracy: 0.7322\n","Epoch 100/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1552 - accuracy: 0.9655 - val_loss: 1.9349 - val_accuracy: 0.7266\n","fit_time :378.8101968765259\n"]}]},{"cell_type":"code","source":["#정확도 f1\n","from sklearn.metrics import *\n","def get_clf_eval(y_test,pred): \n","  f1 = f1_score(y_test,pred,average=\"macro\") \n","  acc = accuracy_score(y_val,predict)   \n","  print('정확도 :',acc)\n","  print('f1 score:',f1)"],"metadata":{"id":"XcUYv2m5SYsG"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["predcit = model.predict(x_val)\n","predict = []\n","for i in np.arange(len(predcit)):\n","  labels = np.argmax(predcit[i])\n","  predict.append(labels)\n","predict = np.array(predict)\n","predict = np_utils.to_categorical(predict)"],"metadata":{"id":"PfFCEym0StOG","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672832969959,"user_tz":-540,"elapsed":424,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"ebcf2b85-e9a6-490c-ae24-56aa7d3df2cf"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["172/172 [==============================] - 0s 2ms/step\n"]}]},{"cell_type":"code","source":["#RGB epoch 100\n","get_clf_eval(y_val,predict)"],"metadata":{"id":"_hT8kJfNS9G_","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672832970341,"user_tz":-540,"elapsed":386,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"99f04886-64ec-4ca8-c256-8cda04863adf"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["정확도 : 0.7265625\n","f1 score: 0.7275204003709238\n"]}]},{"cell_type":"code","source":["# 6. 모델 저장하기\n","from tensorflow.keras.models import load_model\n","model.save('CNN_TEST01_100RGB.h5')"],"metadata":{"id":"Fuza5rCQJWzB"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import time\n","start_time  = time.time()\n","hist = model.fit(x_train, y_train, \n","                    epochs = 50, \n","                    batch_size = 32, \n","                    validation_data = (x_val, y_val), verbose=1)\n","print(f'fit_time :{time.time() - start_time}')"],"metadata":{"id":"J3C7ZT8BSSqe","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833155608,"user_tz":-540,"elapsed":185272,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"0befd4c5-023e-4a1f-dda1-c1a5729888d5"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/50\n","688/688 [==============================] - 4s 6ms/step - loss: 0.1946 - accuracy: 0.9431 - val_loss: 1.8864 - val_accuracy: 0.7231\n","Epoch 2/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1038 - accuracy: 0.9755 - val_loss: 2.8108 - val_accuracy: 0.7278\n","Epoch 3/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0966 - accuracy: 0.9772 - val_loss: 2.5142 - val_accuracy: 0.7155\n","Epoch 4/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1713 - accuracy: 0.9521 - val_loss: 1.8546 - val_accuracy: 0.7286\n","Epoch 5/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0698 - accuracy: 0.9842 - val_loss: 2.3394 - val_accuracy: 0.7189\n","Epoch 6/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0878 - accuracy: 0.9760 - val_loss: 2.6452 - val_accuracy: 0.7364\n","Epoch 7/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1165 - accuracy: 0.9688 - val_loss: 2.1677 - val_accuracy: 0.7131\n","Epoch 8/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1461 - accuracy: 0.9602 - val_loss: 1.7086 - val_accuracy: 0.7362\n","Epoch 9/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1232 - accuracy: 0.9667 - val_loss: 2.2696 - val_accuracy: 0.7224\n","Epoch 10/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0569 - accuracy: 0.9848 - val_loss: 3.0870 - val_accuracy: 0.7393\n","Epoch 11/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1132 - accuracy: 0.9695 - val_loss: 2.5949 - val_accuracy: 0.7168\n","Epoch 12/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1050 - accuracy: 0.9730 - val_loss: 2.8005 - val_accuracy: 0.7217\n","Epoch 13/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0613 - accuracy: 0.9861 - val_loss: 3.5196 - val_accuracy: 0.7218\n","Epoch 14/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.8684 - accuracy: 0.6200 - val_loss: 1.0211 - val_accuracy: 0.4896\n","Epoch 15/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.6391 - accuracy: 0.7312 - val_loss: 2.6193 - val_accuracy: 0.6788\n","Epoch 16/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.3007 - accuracy: 0.9139 - val_loss: 2.2613 - val_accuracy: 0.6666\n","Epoch 17/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1290 - accuracy: 0.9656 - val_loss: 2.9455 - val_accuracy: 0.7284\n","Epoch 18/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.3516 - accuracy: 0.8825 - val_loss: 1.3753 - val_accuracy: 0.6702\n","Epoch 19/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.2410 - accuracy: 0.9440 - val_loss: 1.9494 - val_accuracy: 0.7044\n","Epoch 20/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.2441 - accuracy: 0.9308 - val_loss: 2.0183 - val_accuracy: 0.7142\n","Epoch 21/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1248 - accuracy: 0.9687 - val_loss: 2.9194 - val_accuracy: 0.7088\n","Epoch 22/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0716 - accuracy: 0.9825 - val_loss: 3.1989 - val_accuracy: 0.7217\n","Epoch 23/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0715 - accuracy: 0.9804 - val_loss: 3.4250 - val_accuracy: 0.7202\n","Epoch 24/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1101 - accuracy: 0.9756 - val_loss: 1.8189 - val_accuracy: 0.6437\n","Epoch 25/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1413 - accuracy: 0.9606 - val_loss: 2.5595 - val_accuracy: 0.7324\n","Epoch 26/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.2656 - accuracy: 0.9346 - val_loss: 2.2217 - val_accuracy: 0.7215\n","Epoch 27/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1871 - accuracy: 0.9561 - val_loss: 2.0162 - val_accuracy: 0.6891\n","Epoch 28/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1033 - accuracy: 0.9736 - val_loss: 3.4071 - val_accuracy: 0.7131\n","Epoch 29/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0959 - accuracy: 0.9742 - val_loss: 2.6717 - val_accuracy: 0.7207\n","Epoch 30/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1175 - accuracy: 0.9663 - val_loss: 2.8450 - val_accuracy: 0.7062\n","Epoch 31/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.4613 - accuracy: 0.8110 - val_loss: 0.9927 - val_accuracy: 0.5358\n","Epoch 32/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.3114 - accuracy: 0.8795 - val_loss: 2.6064 - val_accuracy: 0.6977\n","Epoch 33/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.5045 - accuracy: 0.8195 - val_loss: 1.9421 - val_accuracy: 0.5234\n","Epoch 34/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.6180 - accuracy: 0.7542 - val_loss: 2.6232 - val_accuracy: 0.6966\n","Epoch 35/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.3432 - accuracy: 0.9059 - val_loss: 2.7076 - val_accuracy: 0.6550\n","Epoch 36/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.3817 - accuracy: 0.9055 - val_loss: 3.5964 - val_accuracy: 0.7075\n","Epoch 37/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.2539 - accuracy: 0.9254 - val_loss: 2.7053 - val_accuracy: 0.7226\n","Epoch 38/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0642 - accuracy: 0.9819 - val_loss: 3.4731 - val_accuracy: 0.7142\n","Epoch 39/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1533 - accuracy: 0.9580 - val_loss: 4.1964 - val_accuracy: 0.7084\n","Epoch 40/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1477 - accuracy: 0.9585 - val_loss: 3.4768 - val_accuracy: 0.7011\n","Epoch 41/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.5804 - accuracy: 0.7768 - val_loss: 3.4552 - val_accuracy: 0.6657\n","Epoch 42/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.3187 - accuracy: 0.8751 - val_loss: 2.6139 - val_accuracy: 0.7111\n","Epoch 43/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.3566 - accuracy: 0.8873 - val_loss: 2.8178 - val_accuracy: 0.7104\n","Epoch 44/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.6295 - accuracy: 0.7583 - val_loss: 1.8420 - val_accuracy: 0.6524\n","Epoch 45/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.3059 - accuracy: 0.8953 - val_loss: 2.6180 - val_accuracy: 0.6949\n","Epoch 46/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1348 - accuracy: 0.9562 - val_loss: 5.2258 - val_accuracy: 0.7193\n","Epoch 47/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.2161 - accuracy: 0.9294 - val_loss: 2.9354 - val_accuracy: 0.7168\n","Epoch 48/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.4202 - accuracy: 0.8333 - val_loss: 1.9358 - val_accuracy: 0.7002\n","Epoch 49/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.4223 - accuracy: 0.8494 - val_loss: 3.9384 - val_accuracy: 0.6862\n","Epoch 50/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.3874 - accuracy: 0.8671 - val_loss: 2.9383 - val_accuracy: 0.6820\n","fit_time :185.3383605480194\n"]}]},{"cell_type":"code","source":["predcit = model.predict(x_val)\n","predict = []\n","for i in np.arange(len(predcit)):\n","  labels = np.argmax(predcit[i])\n","  predict.append(labels)\n","predict = np.array(predict)\n","predict = np_utils.to_categorical(predict)"],"metadata":{"id":"2lffDwtUUDE-","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833156028,"user_tz":-540,"elapsed":450,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"d6b03634-2da0-43a5-b429-6fdae845b64f"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["172/172 [==============================] - 0s 2ms/step\n"]}]},{"cell_type":"code","source":["#RGB Epoch 50\n","get_clf_eval(y_val,predict)"],"metadata":{"id":"zuoKU7y8UDHW","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833156407,"user_tz":-540,"elapsed":384,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"500f361d-15e9-4768-db4f-3aa9535e92dd"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["정확도 : 0.6820494186046512\n","f1 score: 0.6710397242867713\n"]}]},{"cell_type":"code","source":["# 6. 모델 저장하기\n","from tensorflow.keras.models import load_model\n","model.save('CNN_TEST01_50RGB.h5')"],"metadata":{"id":"7I5nf_PoUDJO"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import time\n","start_time  = time.time()\n","hist = model.fit(x_train, y_train, \n","                    epochs = 10, \n","                    batch_size = 32, \n","                    validation_data = (x_val, y_val), verbose=1)\n","print(f'fit_time :{time.time() - start_time}')"],"metadata":{"id":"mKtV6yEnUQWr","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833193700,"user_tz":-540,"elapsed":37301,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"43e19a32-0f0f-4501-dd3e-22c9e1300cb8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/10\n","688/688 [==============================] - 4s 6ms/step - loss: 0.1414 - accuracy: 0.9520 - val_loss: 2.4777 - val_accuracy: 0.7168\n","Epoch 2/10\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1541 - accuracy: 0.9567 - val_loss: 3.9242 - val_accuracy: 0.7059\n","Epoch 3/10\n","688/688 [==============================] - 4s 5ms/step - loss: 0.3466 - accuracy: 0.8913 - val_loss: 2.2937 - val_accuracy: 0.6027\n","Epoch 4/10\n","688/688 [==============================] - 4s 5ms/step - loss: 0.6565 - accuracy: 0.7569 - val_loss: 1.2840 - val_accuracy: 0.5563\n","Epoch 5/10\n","688/688 [==============================] - 4s 5ms/step - loss: 0.3661 - accuracy: 0.8531 - val_loss: 3.2675 - val_accuracy: 0.6986\n","Epoch 6/10\n","688/688 [==============================] - 4s 5ms/step - loss: 0.4925 - accuracy: 0.8124 - val_loss: 3.8159 - val_accuracy: 0.6572\n","Epoch 7/10\n","688/688 [==============================] - 4s 5ms/step - loss: 0.4054 - accuracy: 0.8403 - val_loss: 2.0526 - val_accuracy: 0.6570\n","Epoch 8/10\n","688/688 [==============================] - 4s 5ms/step - loss: 0.2021 - accuracy: 0.9340 - val_loss: 3.8528 - val_accuracy: 0.7115\n","Epoch 9/10\n","688/688 [==============================] - 4s 5ms/step - loss: 0.4860 - accuracy: 0.8452 - val_loss: 2.5802 - val_accuracy: 0.6713\n","Epoch 10/10\n","688/688 [==============================] - 4s 5ms/step - loss: 0.4916 - accuracy: 0.8058 - val_loss: 3.1296 - val_accuracy: 0.6768\n","fit_time :37.49888896942139\n"]}]},{"cell_type":"code","source":["predcit = model.predict(x_val)\n","predict = []\n","for i in np.arange(len(predcit)):\n","  labels = np.argmax(predcit[i])\n","  predict.append(labels)\n","predict = np.array(predict)\n","predict = np_utils.to_categorical(predict)"],"metadata":{"id":"TbdFCVq_UQYy","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833194502,"user_tz":-540,"elapsed":832,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"320a426f-5981-4224-a910-334662900e05"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["172/172 [==============================] - 0s 2ms/step\n"]}]},{"cell_type":"code","source":["#RGB Epoch 10\n","get_clf_eval(y_val,predict)"],"metadata":{"id":"7agkFOw4UQa7","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833194503,"user_tz":-540,"elapsed":15,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"fd820461-f3a3-43ef-caff-8b538d702755"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["정확도 : 0.676780523255814\n","f1 score: 0.6795489433501986\n"]}]},{"cell_type":"code","source":["# 6. 모델 저장하기\n","from tensorflow.keras.models import load_model\n","model.save('CNN_TEST01_10RGB.h5')"],"metadata":{"id":"MY_EycQBUT1G"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Rxjrp7TSKveI"},"outputs":[],"source":["#데이터 분할\n","from sklearn.model_selection import train_test_split\n","x_train, x_val, y_train, y_val = train_test_split(x_gray, y, shuffle =True, test_size = 0.2, random_state = 123)"]},{"cell_type":"code","source":["# 모형(단순모형, 복잡한 함수형 모형)\n","from keras.layers.convolutional import Conv2D\n","from keras.layers.convolutional import MaxPooling2D\n","from keras.layers import Dense\n","from keras.layers import Flatten\n","from keras.optimizers import Adam\n","\n","model  = tf.keras.models.Sequential()\n","model.add(Conv2D(32, padding = 'same', kernel_size=(5,5), activation='relu', input_shape=(96,96,1)))\n","model.add(MaxPooling2D(pool_size=(2, 2),padding = 'same'))\n","\n","model.add(Conv2D(64,kernel_size=(3,3),activation='relu', padding = 'same'))\n","model.add(MaxPooling2D(pool_size=(2, 2), padding = 'same'))\n","\n","model.add(Conv2D(64,kernel_size=(5,5),activation='relu', padding = 'same'))\n","model.add(MaxPooling2D(pool_size=(2, 2), padding = 'same'))\n","\n","model.add(Conv2D(128,kernel_size=(3,3),activation='relu', padding = 'same'))\n","model.add(MaxPooling2D(pool_size=(2, 2), padding = 'same'))\n","\n","model.add(Conv2D(128,kernel_size=(5,5),activation='relu', padding = 'same'))\n","model.add(MaxPooling2D(pool_size=(2, 2), padding = 'same') )\n","\n","model.add(Flatten())\n","model.add(Dense(256,activation='relu'))\n","model.add(Dense(4,activation='softmax'))\n","\n","model.compile(optimizer=Adam(1e-03), \n","              loss = 'categorical_crossentropy', \n","              metrics = ['accuracy'])"],"metadata":{"id":"IkaKIx8-qxcp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import time\n","start_time  = time.time()\n","hist = model.fit(x_train, y_train, \n","                    epochs = 100, \n","                    batch_size = 32, \n","                    validation_data = (x_val, y_val), verbose=1)\n","print(f'fit_time :{time.time() - start_time}')"],"metadata":{"id":"DFkMJrvOUiIu","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833539302,"user_tz":-540,"elapsed":344807,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"c124a08b-4222-47a5-b23a-7642722059e0"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.9435 - accuracy: 0.5667 - val_loss: 0.7596 - val_accuracy: 0.6141\n","Epoch 2/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.7577 - accuracy: 0.6341 - val_loss: 0.7113 - val_accuracy: 0.6713\n","Epoch 3/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.7152 - accuracy: 0.6563 - val_loss: 0.7168 - val_accuracy: 0.6626\n","Epoch 4/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.6775 - accuracy: 0.6810 - val_loss: 0.6755 - val_accuracy: 0.6991\n","Epoch 5/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.6393 - accuracy: 0.7064 - val_loss: 0.7008 - val_accuracy: 0.6806\n","Epoch 6/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.6049 - accuracy: 0.7245 - val_loss: 0.6702 - val_accuracy: 0.6955\n","Epoch 7/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.5616 - accuracy: 0.7497 - val_loss: 0.6691 - val_accuracy: 0.7066\n","Epoch 8/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.5255 - accuracy: 0.7704 - val_loss: 0.6766 - val_accuracy: 0.7042\n","Epoch 9/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.4611 - accuracy: 0.8037 - val_loss: 0.7496 - val_accuracy: 0.7120\n","Epoch 10/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.4099 - accuracy: 0.8301 - val_loss: 0.7176 - val_accuracy: 0.7175\n","Epoch 11/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.3519 - accuracy: 0.8573 - val_loss: 0.8289 - val_accuracy: 0.7024\n","Epoch 12/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.3139 - accuracy: 0.8755 - val_loss: 0.7997 - val_accuracy: 0.7109\n","Epoch 13/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.2485 - accuracy: 0.9028 - val_loss: 0.9587 - val_accuracy: 0.7115\n","Epoch 14/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.2367 - accuracy: 0.9081 - val_loss: 1.0205 - val_accuracy: 0.7080\n","Epoch 15/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.2233 - accuracy: 0.9149 - val_loss: 1.0848 - val_accuracy: 0.7080\n","Epoch 16/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1745 - accuracy: 0.9355 - val_loss: 1.2123 - val_accuracy: 0.7209\n","Epoch 17/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1616 - accuracy: 0.9411 - val_loss: 1.1881 - val_accuracy: 0.7149\n","Epoch 18/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1613 - accuracy: 0.9403 - val_loss: 1.1971 - val_accuracy: 0.7193\n","Epoch 19/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1369 - accuracy: 0.9521 - val_loss: 1.2560 - val_accuracy: 0.7189\n","Epoch 20/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1234 - accuracy: 0.9569 - val_loss: 1.4410 - val_accuracy: 0.7182\n","Epoch 21/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1291 - accuracy: 0.9544 - val_loss: 1.4599 - val_accuracy: 0.7098\n","Epoch 22/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1147 - accuracy: 0.9603 - val_loss: 1.4511 - val_accuracy: 0.7233\n","Epoch 23/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1292 - accuracy: 0.9559 - val_loss: 1.3989 - val_accuracy: 0.7238\n","Epoch 24/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1283 - accuracy: 0.9582 - val_loss: 1.4300 - val_accuracy: 0.7226\n","Epoch 25/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0952 - accuracy: 0.9676 - val_loss: 1.4521 - val_accuracy: 0.7218\n","Epoch 26/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0970 - accuracy: 0.9667 - val_loss: 1.5961 - val_accuracy: 0.7097\n","Epoch 27/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0888 - accuracy: 0.9694 - val_loss: 1.5045 - val_accuracy: 0.7246\n","Epoch 28/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1115 - accuracy: 0.9640 - val_loss: 1.6598 - val_accuracy: 0.7155\n","Epoch 29/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1113 - accuracy: 0.9643 - val_loss: 1.5865 - val_accuracy: 0.7153\n","Epoch 30/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1012 - accuracy: 0.9671 - val_loss: 1.6082 - val_accuracy: 0.7013\n","Epoch 31/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1007 - accuracy: 0.9694 - val_loss: 1.5487 - val_accuracy: 0.7157\n","Epoch 32/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0980 - accuracy: 0.9661 - val_loss: 1.7112 - val_accuracy: 0.7182\n","Epoch 33/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0852 - accuracy: 0.9725 - val_loss: 1.6812 - val_accuracy: 0.7335\n","Epoch 34/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1168 - accuracy: 0.9657 - val_loss: 1.4455 - val_accuracy: 0.7313\n","Epoch 35/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0893 - accuracy: 0.9700 - val_loss: 2.0160 - val_accuracy: 0.7207\n","Epoch 36/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0811 - accuracy: 0.9747 - val_loss: 1.9277 - val_accuracy: 0.7306\n","Epoch 37/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0845 - accuracy: 0.9738 - val_loss: 1.5513 - val_accuracy: 0.7197\n","Epoch 38/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1024 - accuracy: 0.9695 - val_loss: 1.5438 - val_accuracy: 0.7229\n","Epoch 39/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0826 - accuracy: 0.9754 - val_loss: 1.9826 - val_accuracy: 0.7233\n","Epoch 40/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0833 - accuracy: 0.9742 - val_loss: 1.7013 - val_accuracy: 0.7137\n","Epoch 41/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1018 - accuracy: 0.9690 - val_loss: 1.8284 - val_accuracy: 0.7160\n","Epoch 42/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0908 - accuracy: 0.9719 - val_loss: 1.8110 - val_accuracy: 0.7215\n","Epoch 43/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0897 - accuracy: 0.9744 - val_loss: 2.0094 - val_accuracy: 0.7229\n","Epoch 44/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1010 - accuracy: 0.9694 - val_loss: 2.1869 - val_accuracy: 0.7115\n","Epoch 45/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0801 - accuracy: 0.9761 - val_loss: 1.8445 - val_accuracy: 0.7204\n","Epoch 46/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0658 - accuracy: 0.9804 - val_loss: 1.9343 - val_accuracy: 0.7202\n","Epoch 47/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0778 - accuracy: 0.9763 - val_loss: 1.9488 - val_accuracy: 0.7186\n","Epoch 48/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0820 - accuracy: 0.9751 - val_loss: 2.0680 - val_accuracy: 0.7233\n","Epoch 49/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1009 - accuracy: 0.9715 - val_loss: 1.8866 - val_accuracy: 0.7257\n","Epoch 50/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1018 - accuracy: 0.9704 - val_loss: 2.1618 - val_accuracy: 0.7246\n","Epoch 51/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0817 - accuracy: 0.9771 - val_loss: 1.9741 - val_accuracy: 0.7267\n","Epoch 52/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0553 - accuracy: 0.9839 - val_loss: 2.0182 - val_accuracy: 0.7282\n","Epoch 53/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0796 - accuracy: 0.9769 - val_loss: 2.0948 - val_accuracy: 0.7144\n","Epoch 54/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1931 - accuracy: 0.9470 - val_loss: 2.0359 - val_accuracy: 0.7237\n","Epoch 55/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0919 - accuracy: 0.9742 - val_loss: 2.2049 - val_accuracy: 0.7255\n","Epoch 56/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0615 - accuracy: 0.9812 - val_loss: 2.2883 - val_accuracy: 0.7262\n","Epoch 57/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0867 - accuracy: 0.9766 - val_loss: 1.7170 - val_accuracy: 0.7193\n","Epoch 58/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0588 - accuracy: 0.9814 - val_loss: 2.5372 - val_accuracy: 0.7158\n","Epoch 59/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1054 - accuracy: 0.9695 - val_loss: 2.0018 - val_accuracy: 0.7162\n","Epoch 60/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0997 - accuracy: 0.9723 - val_loss: 1.8883 - val_accuracy: 0.7195\n","Epoch 61/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0671 - accuracy: 0.9807 - val_loss: 2.8365 - val_accuracy: 0.7153\n","Epoch 62/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1030 - accuracy: 0.9722 - val_loss: 1.9277 - val_accuracy: 0.7213\n","Epoch 63/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0845 - accuracy: 0.9753 - val_loss: 2.7213 - val_accuracy: 0.7080\n","Epoch 64/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0647 - accuracy: 0.9833 - val_loss: 2.4330 - val_accuracy: 0.7178\n","Epoch 65/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0748 - accuracy: 0.9797 - val_loss: 1.8436 - val_accuracy: 0.7220\n","Epoch 66/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0554 - accuracy: 0.9829 - val_loss: 2.3793 - val_accuracy: 0.7180\n","Epoch 67/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1157 - accuracy: 0.9701 - val_loss: 2.2427 - val_accuracy: 0.7148\n","Epoch 68/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0790 - accuracy: 0.9786 - val_loss: 2.1708 - val_accuracy: 0.7240\n","Epoch 69/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0718 - accuracy: 0.9783 - val_loss: 1.9601 - val_accuracy: 0.7189\n","Epoch 70/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0430 - accuracy: 0.9879 - val_loss: 2.5771 - val_accuracy: 0.7278\n","Epoch 71/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1040 - accuracy: 0.9705 - val_loss: 2.4466 - val_accuracy: 0.7166\n","Epoch 72/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0876 - accuracy: 0.9757 - val_loss: 2.3506 - val_accuracy: 0.7206\n","Epoch 73/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0634 - accuracy: 0.9826 - val_loss: 2.4100 - val_accuracy: 0.7195\n","Epoch 74/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1453 - accuracy: 0.9634 - val_loss: 2.0662 - val_accuracy: 0.7158\n","Epoch 75/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0470 - accuracy: 0.9866 - val_loss: 2.6652 - val_accuracy: 0.7151\n","Epoch 76/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0605 - accuracy: 0.9833 - val_loss: 2.1987 - val_accuracy: 0.7209\n","Epoch 77/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0811 - accuracy: 0.9801 - val_loss: 2.1011 - val_accuracy: 0.7204\n","Epoch 78/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1984 - accuracy: 0.9448 - val_loss: 1.9010 - val_accuracy: 0.7137\n","Epoch 79/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0678 - accuracy: 0.9809 - val_loss: 2.4503 - val_accuracy: 0.7282\n","Epoch 80/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0578 - accuracy: 0.9836 - val_loss: 2.6291 - val_accuracy: 0.7244\n","Epoch 81/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0770 - accuracy: 0.9815 - val_loss: 2.3261 - val_accuracy: 0.7160\n","Epoch 82/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0495 - accuracy: 0.9862 - val_loss: 2.3394 - val_accuracy: 0.7207\n","Epoch 83/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0450 - accuracy: 0.9869 - val_loss: 3.0364 - val_accuracy: 0.7224\n","Epoch 84/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0561 - accuracy: 0.9844 - val_loss: 2.6345 - val_accuracy: 0.7142\n","Epoch 85/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1026 - accuracy: 0.9734 - val_loss: 2.2577 - val_accuracy: 0.7218\n","Epoch 86/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0617 - accuracy: 0.9837 - val_loss: 2.7477 - val_accuracy: 0.7022\n","Epoch 87/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0928 - accuracy: 0.9751 - val_loss: 2.4899 - val_accuracy: 0.7173\n","Epoch 88/100\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1302 - accuracy: 0.9680 - val_loss: 2.5495 - val_accuracy: 0.7204\n","Epoch 89/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0438 - accuracy: 0.9867 - val_loss: 2.3972 - val_accuracy: 0.7169\n","Epoch 90/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0547 - accuracy: 0.9860 - val_loss: 2.5979 - val_accuracy: 0.7124\n","Epoch 91/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1014 - accuracy: 0.9749 - val_loss: 2.2338 - val_accuracy: 0.7135\n","Epoch 92/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0835 - accuracy: 0.9777 - val_loss: 2.3578 - val_accuracy: 0.6977\n","Epoch 93/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0849 - accuracy: 0.9778 - val_loss: 2.3444 - val_accuracy: 0.7149\n","Epoch 94/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0522 - accuracy: 0.9859 - val_loss: 2.8533 - val_accuracy: 0.7191\n","Epoch 95/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0707 - accuracy: 0.9821 - val_loss: 2.9712 - val_accuracy: 0.7233\n","Epoch 96/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1177 - accuracy: 0.9692 - val_loss: 2.4521 - val_accuracy: 0.7140\n","Epoch 97/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1289 - accuracy: 0.9674 - val_loss: 2.2440 - val_accuracy: 0.7040\n","Epoch 98/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0407 - accuracy: 0.9888 - val_loss: 2.9613 - val_accuracy: 0.7113\n","Epoch 99/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0351 - accuracy: 0.9920 - val_loss: 2.7190 - val_accuracy: 0.7075\n","Epoch 100/100\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0812 - accuracy: 0.9785 - val_loss: 2.9043 - val_accuracy: 0.7148\n","fit_time :344.6161136627197\n"]}]},{"cell_type":"code","source":["predcit = model.predict(x_val)\n","predict = []\n","for i in np.arange(len(predcit)):\n","  labels = np.argmax(predcit[i])\n","  predict.append(labels)\n","predict = np.array(predict)\n","predict = np_utils.to_categorical(predict)"],"metadata":{"id":"97S6Mu57Ul-V","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833539700,"user_tz":-540,"elapsed":428,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"28b72559-1e60-4af8-98b1-9f4d7bbf6fc6"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["172/172 [==============================] - 0s 2ms/step\n"]}]},{"cell_type":"code","source":["#GRAY Epoch 100\n","get_clf_eval(y_val,predict)"],"metadata":{"id":"qeKjikQpUqDl","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833539701,"user_tz":-540,"elapsed":10,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"7a6eff6e-9e70-484f-9d51-7020b43c6649"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["정확도 : 0.7147529069767442\n","f1 score: 0.7132893039669099\n"]}]},{"cell_type":"code","source":["# 6. 모델 저장하기\n","from tensorflow.keras.models import load_model\n","model.save('CNN_TEST01_100G.h5')"],"metadata":{"id":"_qcdtTZ7Jr3l"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import time\n","start_time  = time.time()\n","hist = model.fit(x_train, y_train, \n","                    epochs = 50, \n","                    batch_size = 32, \n","                    validation_data = (x_val, y_val), verbose=1)\n","print(f'fit_time :{time.time() - start_time}')"],"metadata":{"id":"WxGlpPFNUxSl","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833712257,"user_tz":-540,"elapsed":172562,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"b41610a4-c85a-4ef5-913c-03d672792231"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0826 - accuracy: 0.9781 - val_loss: 2.8713 - val_accuracy: 0.7157\n","Epoch 2/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0386 - accuracy: 0.9885 - val_loss: 3.4087 - val_accuracy: 0.7013\n","Epoch 3/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0926 - accuracy: 0.9762 - val_loss: 3.4520 - val_accuracy: 0.7024\n","Epoch 4/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1231 - accuracy: 0.9712 - val_loss: 2.2280 - val_accuracy: 0.7286\n","Epoch 5/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0472 - accuracy: 0.9873 - val_loss: 3.5379 - val_accuracy: 0.7066\n","Epoch 6/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.2479 - accuracy: 0.9309 - val_loss: 2.4640 - val_accuracy: 0.7098\n","Epoch 7/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0730 - accuracy: 0.9807 - val_loss: 2.2835 - val_accuracy: 0.6915\n","Epoch 8/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0579 - accuracy: 0.9846 - val_loss: 3.4800 - val_accuracy: 0.7171\n","Epoch 9/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0481 - accuracy: 0.9872 - val_loss: 3.0803 - val_accuracy: 0.7129\n","Epoch 10/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0393 - accuracy: 0.9899 - val_loss: 3.5153 - val_accuracy: 0.7240\n","Epoch 11/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0701 - accuracy: 0.9828 - val_loss: 2.5849 - val_accuracy: 0.7138\n","Epoch 12/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1801 - accuracy: 0.9566 - val_loss: 2.1644 - val_accuracy: 0.7048\n","Epoch 13/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0560 - accuracy: 0.9847 - val_loss: 2.8934 - val_accuracy: 0.7211\n","Epoch 14/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1687 - accuracy: 0.9554 - val_loss: 2.3890 - val_accuracy: 0.7162\n","Epoch 15/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0672 - accuracy: 0.9828 - val_loss: 2.8891 - val_accuracy: 0.7088\n","Epoch 16/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0568 - accuracy: 0.9865 - val_loss: 2.6192 - val_accuracy: 0.7111\n","Epoch 17/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0320 - accuracy: 0.9933 - val_loss: 3.4931 - val_accuracy: 0.7193\n","Epoch 18/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0550 - accuracy: 0.9859 - val_loss: 2.6034 - val_accuracy: 0.7082\n","Epoch 19/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0761 - accuracy: 0.9804 - val_loss: 2.4576 - val_accuracy: 0.7164\n","Epoch 20/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0879 - accuracy: 0.9762 - val_loss: 1.8913 - val_accuracy: 0.6281\n","Epoch 21/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1545 - accuracy: 0.9639 - val_loss: 2.4457 - val_accuracy: 0.7026\n","Epoch 22/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0600 - accuracy: 0.9839 - val_loss: 3.1412 - val_accuracy: 0.7171\n","Epoch 23/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0548 - accuracy: 0.9871 - val_loss: 3.2061 - val_accuracy: 0.7198\n","Epoch 24/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1104 - accuracy: 0.9723 - val_loss: 2.6753 - val_accuracy: 0.7120\n","Epoch 25/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0496 - accuracy: 0.9870 - val_loss: 2.6066 - val_accuracy: 0.6993\n","Epoch 26/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0695 - accuracy: 0.9829 - val_loss: 3.1017 - val_accuracy: 0.7026\n","Epoch 27/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0694 - accuracy: 0.9832 - val_loss: 3.1471 - val_accuracy: 0.7138\n","Epoch 28/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1115 - accuracy: 0.9790 - val_loss: 3.0976 - val_accuracy: 0.7195\n","Epoch 29/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1731 - accuracy: 0.9563 - val_loss: 2.7338 - val_accuracy: 0.7200\n","Epoch 30/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0832 - accuracy: 0.9802 - val_loss: 3.2584 - val_accuracy: 0.7178\n","Epoch 31/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0489 - accuracy: 0.9884 - val_loss: 3.4261 - val_accuracy: 0.7108\n","Epoch 32/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0924 - accuracy: 0.9794 - val_loss: 3.1317 - val_accuracy: 0.7086\n","Epoch 33/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0285 - accuracy: 0.9925 - val_loss: 2.9253 - val_accuracy: 0.7218\n","Epoch 34/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0485 - accuracy: 0.9882 - val_loss: 2.8304 - val_accuracy: 0.7146\n","Epoch 35/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.3559 - accuracy: 0.9031 - val_loss: 1.9863 - val_accuracy: 0.7142\n","Epoch 36/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1054 - accuracy: 0.9761 - val_loss: 2.8417 - val_accuracy: 0.7098\n","Epoch 37/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0346 - accuracy: 0.9911 - val_loss: 3.1239 - val_accuracy: 0.7157\n","Epoch 38/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0337 - accuracy: 0.9931 - val_loss: 4.4190 - val_accuracy: 0.7026\n","Epoch 39/50\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0554 - accuracy: 0.9876 - val_loss: 3.7376 - val_accuracy: 0.7266\n","Epoch 40/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0364 - accuracy: 0.9903 - val_loss: 2.4130 - val_accuracy: 0.7111\n","Epoch 41/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0988 - accuracy: 0.9766 - val_loss: 3.4070 - val_accuracy: 0.7229\n","Epoch 42/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1735 - accuracy: 0.9625 - val_loss: 2.4905 - val_accuracy: 0.7064\n","Epoch 43/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0862 - accuracy: 0.9800 - val_loss: 2.7553 - val_accuracy: 0.7166\n","Epoch 44/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0457 - accuracy: 0.9891 - val_loss: 2.6367 - val_accuracy: 0.7098\n","Epoch 45/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0741 - accuracy: 0.9852 - val_loss: 2.6062 - val_accuracy: 0.7135\n","Epoch 46/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0522 - accuracy: 0.9874 - val_loss: 2.8674 - val_accuracy: 0.7211\n","Epoch 47/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0419 - accuracy: 0.9906 - val_loss: 3.8911 - val_accuracy: 0.6775\n","Epoch 48/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1084 - accuracy: 0.9747 - val_loss: 3.1561 - val_accuracy: 0.7193\n","Epoch 49/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0525 - accuracy: 0.9890 - val_loss: 3.8063 - val_accuracy: 0.7133\n","Epoch 50/50\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1149 - accuracy: 0.9752 - val_loss: 1.3431 - val_accuracy: 0.6615\n","fit_time :172.4317181110382\n"]}]},{"cell_type":"code","source":["predcit = model.predict(x_val)\n","predict = []\n","for i in np.arange(len(predcit)):\n","  labels = np.argmax(predcit[i])\n","  predict.append(labels)\n","predict = np.array(predict)\n","predict = np_utils.to_categorical(predict)"],"metadata":{"id":"6MO9nMlYUxUk","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833712784,"user_tz":-540,"elapsed":555,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"c3548cda-fda0-47aa-da4e-ec3e97fd3f3c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["172/172 [==============================] - 0s 2ms/step\n"]}]},{"cell_type":"code","source":["#GRAY Epoch 50\n","get_clf_eval(y_val,predict)"],"metadata":{"id":"2yczCqm3UxWs","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833712785,"user_tz":-540,"elapsed":9,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"a9c3f888-5215-4092-81ac-5d11a3305234"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["정확도 : 0.6615188953488372\n","f1 score: 0.6583377821082776\n"]}]},{"cell_type":"code","source":["# 6. 모델 저장하기\n","from tensorflow.keras.models import load_model\n","model.save('CNN_TEST01_50G.h5')"],"metadata":{"id":"nT71KZLvUxaw"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import time\n","start_time  = time.time()\n","hist = model.fit(x_train, y_train, \n","                    epochs = 10, \n","                    batch_size = 32, \n","                    validation_data = (x_val, y_val), verbose=1)\n","print(f'fit_time :{time.time() - start_time}')"],"metadata":{"id":"t7n2Lb-gUxdF","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833747887,"user_tz":-540,"elapsed":34633,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"52a91ff8-cf66-4ad1-dbb2-8048f0048ead"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/10\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0833 - accuracy: 0.9774 - val_loss: 2.6059 - val_accuracy: 0.7066\n","Epoch 2/10\n","688/688 [==============================] - 4s 5ms/step - loss: 0.0524 - accuracy: 0.9883 - val_loss: 3.2572 - val_accuracy: 0.7189\n","Epoch 3/10\n","688/688 [==============================] - 4s 5ms/step - loss: 0.1127 - accuracy: 0.9766 - val_loss: 2.4970 - val_accuracy: 0.7206\n","Epoch 4/10\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1598 - accuracy: 0.9624 - val_loss: 2.8363 - val_accuracy: 0.7117\n","Epoch 5/10\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0503 - accuracy: 0.9863 - val_loss: 3.1657 - val_accuracy: 0.7088\n","Epoch 6/10\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0469 - accuracy: 0.9884 - val_loss: 2.8005 - val_accuracy: 0.7064\n","Epoch 7/10\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0444 - accuracy: 0.9890 - val_loss: 3.1800 - val_accuracy: 0.7144\n","Epoch 8/10\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1665 - accuracy: 0.9552 - val_loss: 3.3631 - val_accuracy: 0.7049\n","Epoch 9/10\n","688/688 [==============================] - 3s 5ms/step - loss: 0.0527 - accuracy: 0.9872 - val_loss: 3.5971 - val_accuracy: 0.6969\n","Epoch 10/10\n","688/688 [==============================] - 3s 5ms/step - loss: 0.1106 - accuracy: 0.9711 - val_loss: 3.6356 - val_accuracy: 0.7031\n","fit_time :35.0536162853241\n"]}]},{"cell_type":"code","source":["predcit = model.predict(x_val)\n","predict = []\n","for i in np.arange(len(predcit)):\n","  labels = np.argmax(predcit[i])\n","  predict.append(labels)\n","predict = np.array(predict)\n","predict = np_utils.to_categorical(predict)"],"metadata":{"id":"jy6wkJmZU2ul","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833748669,"user_tz":-540,"elapsed":395,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"5e2a1471-bdc2-4a6e-e2df-e3ec9df72857"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["172/172 [==============================] - 0s 2ms/step\n"]}]},{"cell_type":"code","source":["#Gray Epoch 10\n","get_clf_eval(y_val,predict)"],"metadata":{"id":"GTaF_yASU2wl","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1672833748670,"user_tz":-540,"elapsed":19,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"807b204d-96ea-4e17-e178-26235453e546"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["정확도 : 0.703125\n","f1 score: 0.698442702464343\n"]}]},{"cell_type":"code","source":["# 6. 모델 저장하기\n","from tensorflow.keras.models import load_model\n","model.save('CNN_TEST01_10G.h5')"],"metadata":{"id":"OOyZ6cr_U2y4"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["load_model = tensorflow.keras.models.load_model('model')"],"metadata":{"id":"QdNY2z4xAaIZ"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"machine_shape":"hm","provenance":[{"file_id":"1BElZfrZD0cVx6KZOM53ta1tX4ikKFFw8","timestamp":1672799991199}],"authorship_tag":"ABX9TyOg2qLu0hd9JZo+xZjTqY4H"},"gpuClass":"premium","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}