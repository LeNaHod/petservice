{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":5457,"status":"ok","timestamp":1672891434576,"user":{"displayName":"박준원","userId":"13178446148627772304"},"user_tz":-540},"id":"YU1KfyDKQXQR"},"outputs":[],"source":["import os\n","import io\n","from zipfile import ZipFile\n","import pandas as pd\n","import tensorflow as tf\n","from PIL import Image\n","import numpy as np\n","import random\n","import matplotlib.image as mpimg\n","import matplotlib.pyplot as plt\n","import cv2\n","from sklearn.metrics import *\n","import os\n","import zipfile\n","from google.colab import drive\n","from keras.utils import np_utils\n","from sklearn.model_selection import train_test_split\n","from tensorflow.keras.preprocessing.image import ImageDataGenerator"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16762,"status":"ok","timestamp":1672891451329,"user":{"displayName":"박준원","userId":"13178446148627772304"},"user_tz":-540},"id":"sZU6PSQpQdmo","outputId":"7c69c78d-8117-4197-f245-9fdb5bea21a9"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":3,"metadata":{"executionInfo":{"elapsed":18978,"status":"ok","timestamp":1672891470300,"user":{"displayName":"박준원","userId":"13178446148627772304"},"user_tz":-540},"id":"GSeRTV9lQdrX"},"outputs":[],"source":["import os\n","import zipfile\n","local_zip = '/content/drive/MyDrive/eyes_train.zip'\n","zip_ref = zipfile.ZipFile(local_zip, 'r')\n","zip_ref.extractall('/content')\n","zip_ref.close()"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":36685,"status":"ok","timestamp":1672891506974,"user":{"displayName":"박준원","userId":"13178446148627772304"},"user_tz":-540},"id":"mgJ9dqhqQdvf"},"outputs":[],"source":["img_dir0 = '/content/eyes_train/eye_train/0'\n","img0 = os.listdir(img_dir0)\n","image0 = list(filter(lambda x: x.find('.jpg') != -1 or x.find('.png') != -1, img0))\n","label0 = list(filter(lambda x : x.find('.json')!=-1,img0))\n","image_0 = []\n","gray_0 = []\n","image_label0 = []\n","for i in image0:\n","    img = np.array(Image.open('/content/eyes_train/eye_train/0/{}'.format(i)))\n","    im0 = cv2.resize(img,(224,224))\n","    image_0.append(im0)\n","    m0 = cv2.cvtColor(im0,cv2.COLOR_BGR2GRAY)\n","    gray_0.append(m0)\n","    image_label0.append(0)"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"WQr3R50dYS8P","executionInfo":{"status":"ok","timestamp":1672891528590,"user_tz":-540,"elapsed":21627,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"outputs":[],"source":["img_dir1 = '/content/eyes_train/eye_train/1'\n","img1 = os.listdir(img_dir1)\n","image1 = list(filter(lambda x: x.find('.jpg') != -1 or x.find('.png') != -1, img1))\n","label1 = list(filter(lambda x : x.find('.json')!=-1,img1))\n","for i in image1:\n","    img = np.array(Image.open('/content/eyes_train/eye_train/1/{}'.format(i)))\n","    im1 = cv2.resize(img,(224,224))\n","    image_0.append(im1)\n","    m1 = cv2.cvtColor(im1,cv2.COLOR_BGR2GRAY)\n","    gray_0.append(m1)\n","    image_label0.append(1)"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"YdRLzUZuYgdV","executionInfo":{"status":"ok","timestamp":1672891550030,"user_tz":-540,"elapsed":21444,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"outputs":[],"source":["img_dir2 = '/content/eyes_train/eye_train/2'\n","img2 = os.listdir(img_dir2)\n","image2 = list(filter(lambda x: x.find('.jpg') != -1 or x.find('.png') != -1, img2))\n","label2 = list(filter(lambda x : x.find('.json')!=-1,img2))\n","for i in image2:\n","    img = np.array(Image.open('/content/eyes_train/eye_train/2/{}'.format(i)))\n","    im2 = cv2.resize(img,(224,224))\n","    image_0.append(im2)\n","    m2 = cv2.cvtColor(im2,cv2.COLOR_BGR2GRAY)\n","    gray_0.append(m2)\n","    image_label0.append(2)"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"Z-gR29u-YrO-","executionInfo":{"status":"ok","timestamp":1672891571234,"user_tz":-540,"elapsed":21224,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"outputs":[],"source":["img_dir3 = '/content/eyes_train/eye_train/3'\n","img3 = os.listdir(img_dir3)\n","image3 = list(filter(lambda x: x.find('.jpg') != -1 or x.find('.png') != -1, img3))\n","label3 = list(filter(lambda x : x.find('.json')!=-1,img3))\n","for i in image3:\n","    img = np.array(Image.open('/content/eyes_train/eye_train/3/{}'.format(i)))\n","    im3 = cv2.resize(img,(224,224))\n","    image_0.append(im3)\n","    m3 = cv2.cvtColor(im3,cv2.COLOR_BGR2GRAY)\n","    gray_0.append(m3)\n","    image_label0.append(3)"]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"e2YCqittQMfv","executionInfo":{"status":"ok","timestamp":1672879908954,"user_tz":-540,"elapsed":15,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"10a4de3f-859a-461e-f96e-aa1c558ec4fe"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["27520"]},"metadata":{},"execution_count":8}],"source":["len(image_0)"]},{"cell_type":"code","source":["max_output_value = 255\n","neighborhood_size = 191\n","subtract_from_mean = 10\n","x = []\n","for i in range(len(gray_0)):\n","  binary = cv2.adaptiveThreshold(gray_0[i], max_output_value,\n","                                          cv2.ADAPTIVE_THRESH_GAUSSIAN_C, cv2.THRESH_BINARY,\n","                                          neighborhood_size, subtract_from_mean)\n","  x.append(binary)"],"metadata":{"id":"5UvBoBSfPQT2","executionInfo":{"status":"ok","timestamp":1672891672909,"user_tz":-540,"elapsed":98487,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"execution_count":8,"outputs":[]},{"cell_type":"code","source":["x = np.array(x)"],"metadata":{"id":"ye86tc9IXXwW","executionInfo":{"status":"ok","timestamp":1672891676347,"user_tz":-540,"elapsed":862,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"execution_count":9,"outputs":[]},{"cell_type":"code","source":["from matplotlib import pyplot as plt\n","plt.imshow(x[0])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":287},"id":"Oc4qA5YHHRV0","executionInfo":{"status":"ok","timestamp":1672891732202,"user_tz":-540,"elapsed":342,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"45461bd7-90d5-42af-e583-87e309477d76"},"execution_count":11,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<matplotlib.image.AxesImage at 0x7f83aa5064f0>"]},"metadata":{},"execution_count":11},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"code","source":["x.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"CT9C3l5TXejx","executionInfo":{"status":"ok","timestamp":1672879997207,"user_tz":-540,"elapsed":23,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"b28799f7-7289-4fa5-d684-8a3071f0022b"},"execution_count":11,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(27520, 224, 224)"]},"metadata":{},"execution_count":11}]},{"cell_type":"code","execution_count":12,"metadata":{"id":"ytapCecaahIW","executionInfo":{"status":"ok","timestamp":1672879997207,"user_tz":-540,"elapsed":21,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"outputs":[],"source":["y = np.array(image_label0)"]},{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HmPySCYaSAZY","executionInfo":{"status":"ok","timestamp":1672879997208,"user_tz":-540,"elapsed":21,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"586c94a1-9b95-46b4-fdea-4a94417ea181"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(27520,)"]},"metadata":{},"execution_count":13}],"source":["y.shape"]},{"cell_type":"code","execution_count":14,"metadata":{"id":"b0y-ocW8IPW_","executionInfo":{"status":"ok","timestamp":1672879997209,"user_tz":-540,"elapsed":17,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"outputs":[],"source":["y = y.reshape(27520,1)"]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Y2SqiLOqSFA5","executionInfo":{"status":"ok","timestamp":1672879997210,"user_tz":-540,"elapsed":17,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"a781472e-f881-45dd-e4b9-fb0c7d8e40a3"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0],\n","       [0],\n","       [0],\n","       ...,\n","       [3],\n","       [3],\n","       [3]])"]},"metadata":{},"execution_count":15}],"source":["y"]},{"cell_type":"code","execution_count":16,"metadata":{"id":"eTtjlQCBZKwG","executionInfo":{"status":"ok","timestamp":1672879997210,"user_tz":-540,"elapsed":12,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"outputs":[],"source":["from keras.utils import np_utils\n","y = np_utils.to_categorical(y)"]},{"cell_type":"code","execution_count":17,"metadata":{"id":"sBiRvd3nZMd9","executionInfo":{"status":"ok","timestamp":1672880009992,"user_tz":-540,"elapsed":12793,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"outputs":[],"source":["#데이터 분할\n","from sklearn.model_selection import train_test_split\n","x_train, x_val, y_train, y_val = train_test_split(x, y, shuffle =True, test_size = 0.2, random_state = 123)"]},{"cell_type":"code","execution_count":20,"metadata":{"id":"LsPn2myrIonc","executionInfo":{"status":"ok","timestamp":1672880018266,"user_tz":-540,"elapsed":274,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"outputs":[],"source":["# 모형(단순모형, 복잡한 함수형 모형)\n","from keras.layers.convolutional import Conv2D\n","from keras.layers.convolutional import MaxPooling2D\n","from keras.layers import Dense\n","from keras.layers import Flatten\n","from keras.optimizers import Adam\n","\n","model  = tf.keras.models.Sequential()\n","model.add(Conv2D(32, padding = 'same', kernel_size=(5,5), activation='relu', input_shape=(224,224,1)))\n","model.add(MaxPooling2D(pool_size=(2, 2),padding = 'same'))\n","\n","model.add(Conv2D(64,kernel_size=(3,3),activation='relu', padding = 'same'))\n","model.add(MaxPooling2D(pool_size=(2, 2), padding = 'same'))\n","\n","model.add(Conv2D(64,kernel_size=(5,5),activation='relu', padding = 'same'))\n","model.add(MaxPooling2D(pool_size=(2, 2), padding = 'same'))\n","\n","model.add(Conv2D(128,kernel_size=(3,3),activation='relu', padding = 'same'))\n","model.add(MaxPooling2D(pool_size=(2, 2), padding = 'same'))\n","\n","model.add(Conv2D(128,kernel_size=(5,5),activation='relu', padding = 'same'))\n","model.add(MaxPooling2D(pool_size=(2, 2), padding = 'same') )\n","\n","model.add(Flatten())\n","model.add(Dense(256,activation='relu'))\n","model.add(Dense(4,activation='softmax'))\n","\n","model.compile(optimizer=Adam(1e-03), \n","              loss = 'categorical_crossentropy', \n","              metrics = ['accuracy'])"]},{"cell_type":"code","source":["import time\n","start_time  = time.time()\n","hist = model.fit(x_train, y_train, \n","                    epochs = 100, \n","                    batch_size = 32, \n","                    validation_data = (x_val, y_val), verbose=1)\n","print(f'fit_time :{time.time() - start_time}')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"76VBC2LuN_Wd","executionInfo":{"status":"ok","timestamp":1672880895898,"user_tz":-540,"elapsed":872679,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"d4a1d5d0-ca5a-4bcf-d42f-47eb51ef4668"},"execution_count":21,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/100\n","688/688 [==============================] - 20s 13ms/step - loss: 1.7453 - accuracy: 0.5017 - val_loss: 0.8559 - val_accuracy: 0.5445\n","Epoch 2/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.8566 - accuracy: 0.5468 - val_loss: 0.8239 - val_accuracy: 0.5678\n","Epoch 3/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.8226 - accuracy: 0.5724 - val_loss: 0.8132 - val_accuracy: 0.5830\n","Epoch 4/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.7941 - accuracy: 0.5927 - val_loss: 0.8041 - val_accuracy: 0.5789\n","Epoch 5/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.7664 - accuracy: 0.6141 - val_loss: 0.7828 - val_accuracy: 0.6036\n","Epoch 6/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.7371 - accuracy: 0.6383 - val_loss: 0.7897 - val_accuracy: 0.6123\n","Epoch 7/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.7048 - accuracy: 0.6607 - val_loss: 0.7815 - val_accuracy: 0.6186\n","Epoch 8/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.6690 - accuracy: 0.6843 - val_loss: 0.7646 - val_accuracy: 0.6286\n","Epoch 9/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.6312 - accuracy: 0.7123 - val_loss: 0.8069 - val_accuracy: 0.6381\n","Epoch 10/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.5839 - accuracy: 0.7365 - val_loss: 0.8016 - val_accuracy: 0.6328\n","Epoch 11/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.5325 - accuracy: 0.7615 - val_loss: 0.8848 - val_accuracy: 0.6339\n","Epoch 12/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.4705 - accuracy: 0.7961 - val_loss: 0.9107 - val_accuracy: 0.6274\n","Epoch 13/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.4283 - accuracy: 0.8168 - val_loss: 1.0499 - val_accuracy: 0.6379\n","Epoch 14/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.3663 - accuracy: 0.8449 - val_loss: 1.1044 - val_accuracy: 0.6346\n","Epoch 15/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.3292 - accuracy: 0.8658 - val_loss: 1.1989 - val_accuracy: 0.6357\n","Epoch 16/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.2890 - accuracy: 0.8839 - val_loss: 1.3583 - val_accuracy: 0.6421\n","Epoch 17/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.2544 - accuracy: 0.8981 - val_loss: 1.3033 - val_accuracy: 0.6484\n","Epoch 18/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.2406 - accuracy: 0.9060 - val_loss: 1.5173 - val_accuracy: 0.6481\n","Epoch 19/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.2101 - accuracy: 0.9230 - val_loss: 1.6852 - val_accuracy: 0.6428\n","Epoch 20/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1933 - accuracy: 0.9281 - val_loss: 1.6549 - val_accuracy: 0.6519\n","Epoch 21/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1685 - accuracy: 0.9380 - val_loss: 1.8113 - val_accuracy: 0.6281\n","Epoch 22/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.1745 - accuracy: 0.9380 - val_loss: 1.9845 - val_accuracy: 0.6328\n","Epoch 23/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.1650 - accuracy: 0.9413 - val_loss: 2.1675 - val_accuracy: 0.6453\n","Epoch 24/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1371 - accuracy: 0.9514 - val_loss: 2.0341 - val_accuracy: 0.6470\n","Epoch 25/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.1636 - accuracy: 0.9456 - val_loss: 2.1266 - val_accuracy: 0.6339\n","Epoch 26/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.1524 - accuracy: 0.9473 - val_loss: 2.0283 - val_accuracy: 0.6392\n","Epoch 27/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1246 - accuracy: 0.9572 - val_loss: 2.0530 - val_accuracy: 0.6426\n","Epoch 28/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1206 - accuracy: 0.9599 - val_loss: 2.1062 - val_accuracy: 0.6475\n","Epoch 29/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.1390 - accuracy: 0.9551 - val_loss: 2.3347 - val_accuracy: 0.6419\n","Epoch 30/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1140 - accuracy: 0.9626 - val_loss: 2.7899 - val_accuracy: 0.6459\n","Epoch 31/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1355 - accuracy: 0.9568 - val_loss: 2.2307 - val_accuracy: 0.6457\n","Epoch 32/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.1105 - accuracy: 0.9648 - val_loss: 2.4225 - val_accuracy: 0.6406\n","Epoch 33/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1184 - accuracy: 0.9636 - val_loss: 2.3096 - val_accuracy: 0.6488\n","Epoch 34/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1207 - accuracy: 0.9635 - val_loss: 2.6388 - val_accuracy: 0.6513\n","Epoch 35/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1164 - accuracy: 0.9652 - val_loss: 2.6629 - val_accuracy: 0.6355\n","Epoch 36/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.1154 - accuracy: 0.9660 - val_loss: 2.7824 - val_accuracy: 0.6453\n","Epoch 37/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0844 - accuracy: 0.9730 - val_loss: 3.0326 - val_accuracy: 0.6392\n","Epoch 38/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0974 - accuracy: 0.9693 - val_loss: 3.1527 - val_accuracy: 0.6423\n","Epoch 39/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1116 - accuracy: 0.9651 - val_loss: 3.0282 - val_accuracy: 0.6486\n","Epoch 40/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1105 - accuracy: 0.9671 - val_loss: 2.9433 - val_accuracy: 0.6499\n","Epoch 41/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.1003 - accuracy: 0.9698 - val_loss: 2.8189 - val_accuracy: 0.6473\n","Epoch 42/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0971 - accuracy: 0.9716 - val_loss: 2.5711 - val_accuracy: 0.6203\n","Epoch 43/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1092 - accuracy: 0.9674 - val_loss: 2.7693 - val_accuracy: 0.6533\n","Epoch 44/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0736 - accuracy: 0.9779 - val_loss: 2.7947 - val_accuracy: 0.6492\n","Epoch 45/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0932 - accuracy: 0.9726 - val_loss: 2.9653 - val_accuracy: 0.6470\n","Epoch 46/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1070 - accuracy: 0.9702 - val_loss: 2.9343 - val_accuracy: 0.6503\n","Epoch 47/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0769 - accuracy: 0.9766 - val_loss: 3.0325 - val_accuracy: 0.6572\n","Epoch 48/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0946 - accuracy: 0.9713 - val_loss: 2.8982 - val_accuracy: 0.6484\n","Epoch 49/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0767 - accuracy: 0.9767 - val_loss: 3.0037 - val_accuracy: 0.6504\n","Epoch 50/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.1507 - accuracy: 0.9576 - val_loss: 2.7718 - val_accuracy: 0.6401\n","Epoch 51/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0755 - accuracy: 0.9784 - val_loss: 3.0861 - val_accuracy: 0.6355\n","Epoch 52/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0791 - accuracy: 0.9769 - val_loss: 3.0636 - val_accuracy: 0.6539\n","Epoch 53/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0733 - accuracy: 0.9791 - val_loss: 3.1492 - val_accuracy: 0.6510\n","Epoch 54/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0962 - accuracy: 0.9720 - val_loss: 3.4233 - val_accuracy: 0.6439\n","Epoch 55/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0981 - accuracy: 0.9734 - val_loss: 3.2761 - val_accuracy: 0.6443\n","Epoch 56/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0854 - accuracy: 0.9773 - val_loss: 3.5783 - val_accuracy: 0.6506\n","Epoch 57/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0746 - accuracy: 0.9797 - val_loss: 3.6813 - val_accuracy: 0.6517\n","Epoch 58/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0782 - accuracy: 0.9781 - val_loss: 3.4390 - val_accuracy: 0.6526\n","Epoch 59/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1147 - accuracy: 0.9709 - val_loss: 2.3238 - val_accuracy: 0.6232\n","Epoch 60/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1032 - accuracy: 0.9697 - val_loss: 3.1670 - val_accuracy: 0.6570\n","Epoch 61/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0551 - accuracy: 0.9839 - val_loss: 3.2969 - val_accuracy: 0.6523\n","Epoch 62/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0826 - accuracy: 0.9780 - val_loss: 2.9765 - val_accuracy: 0.6470\n","Epoch 63/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1036 - accuracy: 0.9717 - val_loss: 3.1076 - val_accuracy: 0.6450\n","Epoch 64/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0627 - accuracy: 0.9828 - val_loss: 3.6796 - val_accuracy: 0.6421\n","Epoch 65/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0801 - accuracy: 0.9783 - val_loss: 3.3381 - val_accuracy: 0.6470\n","Epoch 66/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0797 - accuracy: 0.9802 - val_loss: 2.9309 - val_accuracy: 0.6561\n","Epoch 67/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0660 - accuracy: 0.9812 - val_loss: 3.8309 - val_accuracy: 0.6484\n","Epoch 68/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0738 - accuracy: 0.9814 - val_loss: 3.8744 - val_accuracy: 0.6503\n","Epoch 69/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0715 - accuracy: 0.9806 - val_loss: 4.0417 - val_accuracy: 0.6544\n","Epoch 70/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0758 - accuracy: 0.9799 - val_loss: 4.0442 - val_accuracy: 0.6559\n","Epoch 71/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0771 - accuracy: 0.9806 - val_loss: 3.5108 - val_accuracy: 0.6501\n","Epoch 72/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0935 - accuracy: 0.9762 - val_loss: 2.7227 - val_accuracy: 0.6561\n","Epoch 73/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0638 - accuracy: 0.9822 - val_loss: 3.3173 - val_accuracy: 0.6564\n","Epoch 74/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0839 - accuracy: 0.9787 - val_loss: 3.0641 - val_accuracy: 0.6444\n","Epoch 75/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0663 - accuracy: 0.9824 - val_loss: 3.7479 - val_accuracy: 0.6532\n","Epoch 76/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0811 - accuracy: 0.9792 - val_loss: 3.3038 - val_accuracy: 0.6457\n","Epoch 77/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0788 - accuracy: 0.9799 - val_loss: 3.6698 - val_accuracy: 0.6486\n","Epoch 78/100\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0523 - accuracy: 0.9856 - val_loss: 3.5947 - val_accuracy: 0.6621\n","Epoch 79/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0729 - accuracy: 0.9795 - val_loss: 3.9556 - val_accuracy: 0.6544\n","Epoch 80/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0989 - accuracy: 0.9762 - val_loss: 3.3193 - val_accuracy: 0.6543\n","Epoch 81/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0687 - accuracy: 0.9827 - val_loss: 2.8283 - val_accuracy: 0.6234\n","Epoch 82/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1002 - accuracy: 0.9753 - val_loss: 3.7345 - val_accuracy: 0.6552\n","Epoch 83/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0395 - accuracy: 0.9881 - val_loss: 3.9156 - val_accuracy: 0.6584\n","Epoch 84/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0663 - accuracy: 0.9844 - val_loss: 5.1115 - val_accuracy: 0.6512\n","Epoch 85/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0957 - accuracy: 0.9760 - val_loss: 4.0178 - val_accuracy: 0.6506\n","Epoch 86/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0776 - accuracy: 0.9793 - val_loss: 3.8415 - val_accuracy: 0.6481\n","Epoch 87/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0432 - accuracy: 0.9895 - val_loss: 4.7352 - val_accuracy: 0.6423\n","Epoch 88/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0884 - accuracy: 0.9782 - val_loss: 3.5286 - val_accuracy: 0.6415\n","Epoch 89/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0851 - accuracy: 0.9791 - val_loss: 3.9681 - val_accuracy: 0.6566\n","Epoch 90/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0661 - accuracy: 0.9841 - val_loss: 3.4462 - val_accuracy: 0.6493\n","Epoch 91/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0581 - accuracy: 0.9862 - val_loss: 3.9933 - val_accuracy: 0.6519\n","Epoch 92/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0421 - accuracy: 0.9897 - val_loss: 4.0005 - val_accuracy: 0.6539\n","Epoch 93/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0884 - accuracy: 0.9810 - val_loss: 3.7835 - val_accuracy: 0.6546\n","Epoch 94/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0561 - accuracy: 0.9851 - val_loss: 3.9950 - val_accuracy: 0.6599\n","Epoch 95/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0556 - accuracy: 0.9860 - val_loss: 3.1659 - val_accuracy: 0.6599\n","Epoch 96/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1175 - accuracy: 0.9705 - val_loss: 3.5611 - val_accuracy: 0.6572\n","Epoch 97/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0427 - accuracy: 0.9881 - val_loss: 4.8870 - val_accuracy: 0.6512\n","Epoch 98/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0731 - accuracy: 0.9826 - val_loss: 3.8217 - val_accuracy: 0.6595\n","Epoch 99/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0828 - accuracy: 0.9800 - val_loss: 4.0754 - val_accuracy: 0.6523\n","Epoch 100/100\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0701 - accuracy: 0.9833 - val_loss: 3.7357 - val_accuracy: 0.6459\n","fit_time :872.6411607265472\n"]}]},{"cell_type":"code","source":["#정확도 f1\n","from sklearn.metrics import *\n","def get_clf_eval(y_test,pred): \n","  f1 = f1_score(y_test,pred,average=\"macro\") \n","  acc = accuracy_score(y_val,predict)   \n","  loss = model.evaluate(x_val, y_val, batch_size=32)\n","  print('정확도 :',acc)\n","  print('f1 score:',f1)\n","  print('loss :',loss )"],"metadata":{"id":"sykmijKzX393","executionInfo":{"status":"ok","timestamp":1672880895899,"user_tz":-540,"elapsed":34,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"execution_count":22,"outputs":[]},{"cell_type":"code","source":["predcit = model.predict(x_val)\n","predict = []\n","for i in np.arange(len(predcit)):\n","  labels = np.argmax(predcit[i])\n","  predict.append(labels)\n","predict = np.array(predict)\n","predict = np_utils.to_categorical(predict)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tW0uCogvOCZL","executionInfo":{"status":"ok","timestamp":1672880897107,"user_tz":-540,"elapsed":1239,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"eaf3262e-2874-4a54-dfcc-eab4649543b2"},"execution_count":23,"outputs":[{"output_type":"stream","name":"stdout","text":["172/172 [==============================] - 1s 4ms/step\n"]}]},{"cell_type":"code","source":["#Binary Epoch 100\n","get_clf_eval(y_val,predict)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"u7Zk0swMOE8I","executionInfo":{"status":"ok","timestamp":1672880898244,"user_tz":-540,"elapsed":1144,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"6ecb6a65-9fdd-493f-b63b-2834737717c7"},"execution_count":24,"outputs":[{"output_type":"stream","name":"stdout","text":["172/172 [==============================] - 1s 5ms/step - loss: 3.7357 - accuracy: 0.6459\n","정확도 : 0.6458938953488372\n","f1 score: 0.6426395431369565\n","loss : [3.7357177734375, 0.6458938717842102]\n"]}]},{"cell_type":"code","source":["# 6. 모델 저장하기\n","from tensorflow.keras.models import load_model\n","model.save('CNN_TEST01_100BIN.h5')"],"metadata":{"id":"7i-CEGpWOFhg","executionInfo":{"status":"ok","timestamp":1672880898246,"user_tz":-540,"elapsed":10,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"execution_count":25,"outputs":[]},{"cell_type":"code","execution_count":26,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"J3C7ZT8BSSqe","executionInfo":{"status":"ok","timestamp":1672881329589,"user_tz":-540,"elapsed":430958,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"5994c50b-84c6-4740-a56d-a98b2b8ec041"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/50\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0628 - accuracy: 0.9836 - val_loss: 5.5098 - val_accuracy: 0.6577\n","Epoch 2/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0637 - accuracy: 0.9849 - val_loss: 4.5229 - val_accuracy: 0.6513\n","Epoch 3/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0627 - accuracy: 0.9861 - val_loss: 4.1076 - val_accuracy: 0.6461\n","Epoch 4/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0494 - accuracy: 0.9871 - val_loss: 3.7091 - val_accuracy: 0.6497\n","Epoch 5/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0765 - accuracy: 0.9828 - val_loss: 4.5018 - val_accuracy: 0.6475\n","Epoch 6/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0694 - accuracy: 0.9834 - val_loss: 4.2800 - val_accuracy: 0.6581\n","Epoch 7/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0652 - accuracy: 0.9844 - val_loss: 4.1200 - val_accuracy: 0.6621\n","Epoch 8/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0502 - accuracy: 0.9891 - val_loss: 4.0467 - val_accuracy: 0.6479\n","Epoch 9/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0650 - accuracy: 0.9845 - val_loss: 3.7812 - val_accuracy: 0.6553\n","Epoch 10/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0655 - accuracy: 0.9855 - val_loss: 4.9098 - val_accuracy: 0.6606\n","Epoch 11/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0871 - accuracy: 0.9808 - val_loss: 4.0663 - val_accuracy: 0.6499\n","Epoch 12/50\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0526 - accuracy: 0.9866 - val_loss: 4.9479 - val_accuracy: 0.6510\n","Epoch 13/50\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0553 - accuracy: 0.9868 - val_loss: 4.9485 - val_accuracy: 0.6439\n","Epoch 14/50\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0468 - accuracy: 0.9896 - val_loss: 4.9869 - val_accuracy: 0.6477\n","Epoch 15/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0662 - accuracy: 0.9852 - val_loss: 4.0327 - val_accuracy: 0.6406\n","Epoch 16/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0938 - accuracy: 0.9804 - val_loss: 5.1830 - val_accuracy: 0.6510\n","Epoch 17/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1348 - accuracy: 0.9726 - val_loss: 3.5615 - val_accuracy: 0.6453\n","Epoch 18/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0403 - accuracy: 0.9905 - val_loss: 4.9481 - val_accuracy: 0.6562\n","Epoch 19/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0613 - accuracy: 0.9881 - val_loss: 3.8184 - val_accuracy: 0.6499\n","Epoch 20/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0432 - accuracy: 0.9901 - val_loss: 5.0490 - val_accuracy: 0.6617\n","Epoch 21/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0528 - accuracy: 0.9892 - val_loss: 4.5376 - val_accuracy: 0.6544\n","Epoch 22/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0604 - accuracy: 0.9864 - val_loss: 4.3773 - val_accuracy: 0.6484\n","Epoch 23/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0830 - accuracy: 0.9836 - val_loss: 4.1371 - val_accuracy: 0.6521\n","Epoch 24/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0589 - accuracy: 0.9864 - val_loss: 5.5252 - val_accuracy: 0.6630\n","Epoch 25/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0558 - accuracy: 0.9884 - val_loss: 5.2395 - val_accuracy: 0.6582\n","Epoch 26/50\n","688/688 [==============================] - 9s 13ms/step - loss: 0.1336 - accuracy: 0.9737 - val_loss: 4.1430 - val_accuracy: 0.6492\n","Epoch 27/50\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0422 - accuracy: 0.9900 - val_loss: 4.2411 - val_accuracy: 0.6546\n","Epoch 28/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0472 - accuracy: 0.9897 - val_loss: 4.4793 - val_accuracy: 0.6533\n","Epoch 29/50\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0559 - accuracy: 0.9876 - val_loss: 5.6842 - val_accuracy: 0.6590\n","Epoch 30/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0458 - accuracy: 0.9891 - val_loss: 5.1725 - val_accuracy: 0.6606\n","Epoch 31/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0580 - accuracy: 0.9887 - val_loss: 5.0739 - val_accuracy: 0.6526\n","Epoch 32/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0977 - accuracy: 0.9805 - val_loss: 4.4695 - val_accuracy: 0.6484\n","Epoch 33/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0452 - accuracy: 0.9896 - val_loss: 4.7832 - val_accuracy: 0.6588\n","Epoch 34/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0554 - accuracy: 0.9889 - val_loss: 4.6337 - val_accuracy: 0.6562\n","Epoch 35/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0627 - accuracy: 0.9858 - val_loss: 4.1465 - val_accuracy: 0.6524\n","Epoch 36/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0625 - accuracy: 0.9870 - val_loss: 4.2272 - val_accuracy: 0.6513\n","Epoch 37/50\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0654 - accuracy: 0.9855 - val_loss: 4.4540 - val_accuracy: 0.6586\n","Epoch 38/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0393 - accuracy: 0.9917 - val_loss: 5.6767 - val_accuracy: 0.6526\n","Epoch 39/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.1092 - accuracy: 0.9797 - val_loss: 5.8212 - val_accuracy: 0.6443\n","Epoch 40/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0588 - accuracy: 0.9878 - val_loss: 5.1337 - val_accuracy: 0.6612\n","Epoch 41/50\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0393 - accuracy: 0.9915 - val_loss: 5.8720 - val_accuracy: 0.6568\n","Epoch 42/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0531 - accuracy: 0.9891 - val_loss: 4.4855 - val_accuracy: 0.6472\n","Epoch 43/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0484 - accuracy: 0.9903 - val_loss: 5.6624 - val_accuracy: 0.6475\n","Epoch 44/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0626 - accuracy: 0.9860 - val_loss: 6.3084 - val_accuracy: 0.6602\n","Epoch 45/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0572 - accuracy: 0.9875 - val_loss: 5.3763 - val_accuracy: 0.6613\n","Epoch 46/50\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0655 - accuracy: 0.9873 - val_loss: 5.4539 - val_accuracy: 0.6539\n","Epoch 47/50\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0529 - accuracy: 0.9892 - val_loss: 5.9155 - val_accuracy: 0.6652\n","Epoch 48/50\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0677 - accuracy: 0.9868 - val_loss: 5.5528 - val_accuracy: 0.6544\n","Epoch 49/50\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0487 - accuracy: 0.9901 - val_loss: 4.8834 - val_accuracy: 0.6566\n","Epoch 50/50\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0698 - accuracy: 0.9873 - val_loss: 6.4191 - val_accuracy: 0.6646\n","fit_time :431.1573543548584\n"]}],"source":["import time\n","start_time  = time.time()\n","hist = model.fit(x_train, y_train, \n","                    epochs = 50, \n","                    batch_size = 32, \n","                    validation_data = (x_val, y_val), verbose=1)\n","print(f'fit_time :{time.time() - start_time}')"]},{"cell_type":"code","execution_count":27,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2lffDwtUUDE-","executionInfo":{"status":"ok","timestamp":1672881330467,"user_tz":-540,"elapsed":907,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"31ae6420-10a9-4d1f-b221-15d901423126"},"outputs":[{"output_type":"stream","name":"stdout","text":["172/172 [==============================] - 1s 4ms/step\n"]}],"source":["predcit = model.predict(x_val)\n","predict = []\n","for i in np.arange(len(predcit)):\n","  labels = np.argmax(predcit[i])\n","  predict.append(labels)\n","predict = np.array(predict)\n","predict = np_utils.to_categorical(predict)"]},{"cell_type":"code","execution_count":28,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"zuoKU7y8UDHW","executionInfo":{"status":"ok","timestamp":1672881331721,"user_tz":-540,"elapsed":999,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"4dbe259e-c7c3-4ff5-9a9b-c953d6b3c560"},"outputs":[{"output_type":"stream","name":"stdout","text":["172/172 [==============================] - 1s 5ms/step - loss: 6.4191 - accuracy: 0.6646\n","정확도 : 0.6646075581395349\n","f1 score: 0.6603302794297561\n","loss : [6.419129848480225, 0.664607584476471]\n"]}],"source":["#Binary Epoch 50\n","get_clf_eval(y_val,predict)"]},{"cell_type":"code","execution_count":29,"metadata":{"id":"7I5nf_PoUDJO","executionInfo":{"status":"ok","timestamp":1672881331722,"user_tz":-540,"elapsed":7,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"outputs":[],"source":["# 6. 모델 저장하기\n","from tensorflow.keras.models import load_model\n","model.save('CNN_TEST01_50BIN.h5')"]},{"cell_type":"code","execution_count":30,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mKtV6yEnUQWr","executionInfo":{"status":"ok","timestamp":1672881418538,"user_tz":-540,"elapsed":86408,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"926906f5-2e7e-403c-e07e-0fa2cfa6d6a8"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/10\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0333 - accuracy: 0.9933 - val_loss: 6.3979 - val_accuracy: 0.6579\n","Epoch 2/10\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0465 - accuracy: 0.9902 - val_loss: 5.6592 - val_accuracy: 0.6553\n","Epoch 3/10\n","688/688 [==============================] - 9s 13ms/step - loss: 0.0753 - accuracy: 0.9870 - val_loss: 5.3068 - val_accuracy: 0.6588\n","Epoch 4/10\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0335 - accuracy: 0.9929 - val_loss: 6.5783 - val_accuracy: 0.6546\n","Epoch 5/10\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0658 - accuracy: 0.9868 - val_loss: 4.4852 - val_accuracy: 0.6555\n","Epoch 6/10\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0283 - accuracy: 0.9935 - val_loss: 5.5939 - val_accuracy: 0.6568\n","Epoch 7/10\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0636 - accuracy: 0.9877 - val_loss: 5.8135 - val_accuracy: 0.6541\n","Epoch 8/10\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0538 - accuracy: 0.9885 - val_loss: 6.6736 - val_accuracy: 0.6602\n","Epoch 9/10\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0756 - accuracy: 0.9867 - val_loss: 6.3422 - val_accuracy: 0.6597\n","Epoch 10/10\n","688/688 [==============================] - 9s 12ms/step - loss: 0.0431 - accuracy: 0.9912 - val_loss: 6.0122 - val_accuracy: 0.6608\n","fit_time :86.62944531440735\n"]}],"source":["import time\n","start_time  = time.time()\n","hist = model.fit(x_train, y_train, \n","                    epochs = 10, \n","                    batch_size = 32, \n","                    validation_data = (x_val, y_val), verbose=1)\n","print(f'fit_time :{time.time() - start_time}')"]},{"cell_type":"code","execution_count":31,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"TbdFCVq_UQYy","executionInfo":{"status":"ok","timestamp":1672881419341,"user_tz":-540,"elapsed":826,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"f56ade0d-1d14-4491-ff32-1b3bc680165b"},"outputs":[{"output_type":"stream","name":"stdout","text":["172/172 [==============================] - 1s 5ms/step\n"]}],"source":["predcit = model.predict(x_val)\n","predict = []\n","for i in np.arange(len(predcit)):\n","  labels = np.argmax(predcit[i])\n","  predict.append(labels)\n","predict = np.array(predict)\n","predict = np_utils.to_categorical(predict)"]},{"cell_type":"code","execution_count":32,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7agkFOw4UQa7","executionInfo":{"status":"ok","timestamp":1672881420554,"user_tz":-540,"elapsed":1220,"user":{"displayName":"박준원","userId":"13178446148627772304"}},"outputId":"baa7ac00-3112-4b4f-ab6f-bf4b3cb0e426"},"outputs":[{"output_type":"stream","name":"stdout","text":["172/172 [==============================] - 1s 5ms/step - loss: 6.0122 - accuracy: 0.6608\n","정확도 : 0.6607921511627907\n","f1 score: 0.6573455428853918\n","loss : [6.012200832366943, 0.6607921719551086]\n"]}],"source":["#Binary Epoch 10\n","get_clf_eval(y_val,predict)"]},{"cell_type":"code","execution_count":33,"metadata":{"id":"MY_EycQBUT1G","executionInfo":{"status":"ok","timestamp":1672881420556,"user_tz":-540,"elapsed":17,"user":{"displayName":"박준원","userId":"13178446148627772304"}}},"outputs":[],"source":["# 6. 모델 저장하기\n","from tensorflow.keras.models import load_model\n","model.save('CNN_TEST01_10BIN.h5')"]}],"metadata":{"colab":{"machine_shape":"hm","provenance":[{"file_id":"1QwaR9_sbLUVueoym47w_IsHZzn--9YwA","timestamp":1672827459245},{"file_id":"1BElZfrZD0cVx6KZOM53ta1tX4ikKFFw8","timestamp":1672799991199}],"authorship_tag":"ABX9TyNXSsAwrwid+6ZtSVuFynHm"},"gpuClass":"premium","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}